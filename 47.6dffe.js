(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{492:function(t,e,n){"use strict";n.d(e,"a",function(){return p});var r,i=n(1),a=n.n(i),o=n(1295),s=n.n(o),c=(n(485),r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},l=s.a.Item;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.render=function(){return a.a.createElement(l,u({},(t=this.props.valid,e=this.props.messageOnInvalid,n=this.props.messageOnSuccess,{validateStatus:t?"success":"error",help:t?n:e})),this.props.children);var t,e,n},e}(a.a.Component)},637:function(t,e,n){"use strict";n.d(e,"a",function(){return p});var r,i=n(1),a=n.n(i),o=n(1295),s=n.n(o),c=(n(485),r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},l=s.a.Item,p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.render=function(){return a.a.createElement(l,u({},this.props.mapToFormProps(this.props.status)),this.props.children)},e}(a.a.Component)},895:function(t,e,n){"use strict";n.r(e),n.d(e,"MissionPayPage",function(){return _});var r,i=n(1),a=n.n(i),o=n(3),s=(n(485),n(877)),c=n.n(s),u=(n(471),n(144)),l=n.n(u),p=(n(140),n(1294)),f=n.n(p),d=(n(516),n(524)),h=n(29),m=n(492),y=n(18),b=n(72),v=n(20),g=n(637),C=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),O=function(t,e,n,r){var i,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(o=(a<3?i(o):a>3?i(e,n,o):i(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o},w=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},E=function(t,e,n,r){return new(n||(n=Promise))(function(i,a){function o(t){try{c(r.next(t))}catch(t){a(t)}}function s(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,s)}c((r=r.apply(t,e||[])).next())})},I=function(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=r[2&a[0]?"return":a[0]?"throw":"next"])&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[0,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},S="pay.mission.",_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={missionId:e.props.missionId||"",missionIdCheckOutOfDate:!0,value:"10",fetchingRemainingCredits:!1,remainingCredits:0,paying:!1},e.onMissionIdChanged=function(t){e.setState({missionId:t.target.value,missionIdCheckOutOfDate:!0})},e.onValueChanged=function(t){e.setState({value:t.target.value})},e.loadCurrentCredits=function(){return E(e,void 0,void 0,function(){var t;return I(this,function(e){switch(e.label){case 0:if(this.setState({fetchingRemainingCredits:!0}),!this.state.missionId)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.requesterService.getRemainingCreditsForAMission(this.state.missionId,this.props.token)];case 2:return t=e.sent(),this.setState({remainingCredits:t.remainingCredits,fetchingRemainingCredits:!1,missionIdCheckOutOfDate:!1}),[3,4];case 3:return e.sent(),this.setState({remainingCredits:-2,fetchingRemainingCredits:!1,missionIdCheckOutOfDate:!1}),[3,4];case 4:return[2]}})})},e.onSubmit=function(){return E(e,void 0,void 0,function(){var t;return I(this,function(e){switch(e.label){case 0:return this.setState({paying:!0}),this.state.missionIdCheckOutOfDate?[4,this.loadCurrentCredits()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this.submittable()?[4,this.requesterService.payMission(this.state.missionId,parseInt(this.state.value),this.props.token)]:[3,4];case 3:return t=e.sent(),this.setState({remainingCredits:t.remainingCredits,paying:!1}),f.a.success({title:this.localeStore.get(S+"paymentComplete")}),[3,5];case 4:this.setState({paying:!1}),e.label=5;case 5:return[2]}})})},e.remainingPrompt=function(t){return e.state.missionId?e.state.fetchingRemainingCredits?{validateStatus:"validating",help:a.a.createElement(y.b,{id:S+"loading"})}:e.state.missionIdCheckOutOfDate?{validateStatus:"success",help:a.a.createElement(y.b,{id:S+"needCheck",replacements:{click:a.a.createElement("a",{onClick:e.onCheckClicked},a.a.createElement(y.b,{id:S+"click"}))}})}:t>=0?{validateStatus:"success",help:a.a.createElement(y.b,{id:S+"currentCredits",replacements:{credits:t+""}})}:-2==t?{validateStatus:"error",help:a.a.createElement(y.b,{id:S+"missionNotExist"})}:null:{validateStatus:"error",help:a.a.createElement(y.b,{id:S+"inputMissionId"})}},e.onCheckClicked=function(){e.loadCurrentCredits()},e}return C(e,t),e.prototype.componentDidMount=function(){this.state.missionId&&this.loadCurrentCredits()},e.prototype.submittable=function(){return this.payValueValid&&this.state.remainingCredits>=0},Object.defineProperty(e.prototype,"payValueValid",{get:function(){var t=this.state.value;if(t.indexOf(".")>=0)return!1;var e=parseInt(t);return!isNaN(e)&&e>0},enumerable:!0,configurable:!0}),e.prototype.render=function(){return a.a.createElement("div",null,a.a.createElement("h1",null,a.a.createElement(y.b,{id:S+"title"})),a.a.createElement(g.a,{status:this.state.remainingCredits,mapToFormProps:this.remainingPrompt},a.a.createElement(c.a,{addonBefore:a.a.createElement(y.b,{id:S+"missionId"}),value:this.state.missionId,onChange:this.onMissionIdChanged})),a.a.createElement(m.a,{valid:this.payValueValid,messageOnInvalid:a.a.createElement(y.b,{id:S+"format"})},a.a.createElement(c.a,{addonBefore:a.a.createElement(y.b,{id:S+"inputCredits"}),value:this.state.value,onChange:this.onValueChanged})),a.a.createElement(l.a,{loading:this.state.paying,type:"primary",onClick:this.onSubmit},a.a.createElement(y.b,{id:S+"submit"})))},O([o.Inject,w("design:type","function"==typeof(n=void 0!==b.a&&b.a)&&n||Object)],e.prototype,"requesterService",void 0),O([o.Inject,w("design:type","function"==typeof(r=void 0!==v.a&&v.a)&&r||Object)],e.prototype,"localeStore",void 0),e=O([Object(d.a)(h.b.ROLE_REQUESTER)],e);var n,r}(a.a.Component)}}]);